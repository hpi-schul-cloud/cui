!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=65)}({15:function(e,t,n){"use strict";function o(e){e.contentWindow.postMessage(JSON.stringify({function:"getSize",identifier:e.dataset.identifier}),"*")}function i(e){window.addEventListener("message",function(t){try{var n=JSON.parse(t.data);e(n)}catch(e){}},!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.iFrameListen=function(){i(function(e){var t;e.function&&"getSize"===e.function&&e.identifier&&(t=e.identifier,window.parent.postMessage(JSON.stringify({identifier:t,size:{x:document.body.scrollWidth,y:document.body.scrollHeight}}),"*"))})},t.resizeIframes=function(e,t){var n=e;n&&0!==n.length||(n=document.querySelectorAll("iframe"));i(function(e){e.size&&e.identifier&&(document.querySelectorAll('iframe[data-identifier="'+e.identifier+'"]').forEach(function(t){t.style.height=e.size.y+16+"px"}),t&&t())}),function(e){e.forEach(function(e,t){var n="iframe-"+t;e.dataset.identifier=n})}(n),n.forEach(function(e){e.addEventListener("load",function(t){o(e)})});var r;window.addEventListener("resize",(a=function(){n.forEach(function(e){o(e)})},function(){r&&clearTimeout(r),r=setTimeout(function(){r=null,a()},200)}),!1);var a}},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendRegistrationId=function(e,t,n,o,i){$.post("/notification/devices",{id:e,service:t,device:n,type:o,name:i},function(e){document.cookie="notificationPermission=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"})},t.sendShownCallback=function(e,t,n){var i={notificationId:e.notificationId,type:o.RECEIVED};function c(e){console.log(e)}if(t){var s=JSON.stringify(i);return a(n,s,c)}return r(i,c)},t.sendReadCallback=function(e){return r({notificationId:e,type:o.READ},function(e){console.log(e)})},t.sendClickedCallback=function(e,t,n){var i={notificationId:e,type:o.CLICKED};function c(e){console.log(e)}if(t){var s=JSON.stringify(i);return a(n,s,c)}return r(i,c)};var o={RECEIVED:"received",CLICKED:"clicked",READ:"read"},i={"Content-Type":"application/json"};function r(e,t){$.post("/notification/callback",e)}function a(e,t,n){if(self.fetch)fetch(e,{method:"POST",body:t,headers:i}).then(function(e){e.json().then(function(e){n(e)})});else if(self.XMLHttpRequest){var o;(o=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState&&201===this.status){var e=JSON.parse(o.responseText);n(e)}},o.open("POST",e,!0),o.setRequestHeader("Content-type",i["Content-Type"]),o.send(t)}else console.log("No way to send out",t)}},30:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupFirebasePush=function(){if(!window.firebase)return;if(firebase.apps.length)return;firebase.initializeApp({messagingSenderId:"764547597772"});var e=firebase.messaging();navigator.serviceWorker.register("/scripts/notificationService/firebase-messaging-sw.js").then(function(t){function n(){e.getToken().then(function(e){e?o.pushManager.setRegistrationId(e):o.pushManager.error("No Instance ID token available. Request permission to generate one."),o.pushManager.registerSuccessfulSetup("firebase",r)}).catch(function(e){o.pushManager.error(e,"Unable to retrieve refreshed token ")})}function r(){e.requestPermission().then(function(){n()}).catch(function(e){o.pushManager.error(e,"Unable to get permission to notify.")})}e.useServiceWorker(t),e.onTokenRefresh(n),e.onMessage(function(e){e.data.notification=JSON.parse(e.data.news);var n=e.data.notification.title,o={body:e.data.notification.body,icon:e.data.notification.img||"/images/cloud.png",data:e.data};return(0,i.sendShownCallback)(e.data),t.showNotification(n,o)}),n()})};var o=n(9),i=n(3)},65:function(e,t,n){e.exports=n(66)},66:function(e,t,n){"use strict";var o,i,r=n(30),a=n(3);function c(){document.querySelector("aside.nav-sidebar").classList.toggle("active"),this.classList.toggle("active")}function s(){document.querySelector(".search-wrapper .input-group").classList.toggle("active"),document.querySelector(".search-wrapper .mobile-search-toggle .fa").classList.toggle("fa-search"),document.querySelector(".search-wrapper .mobile-search-toggle .fa").classList.toggle("fa-times")}function d(){$("#main-content");var e=$(".btn-fullscreen");$("body").toggleClass("fullscreen"),e.children("i").toggleClass("fa-compress"),e.children("i").toggleClass("fa-expand")}(0,n(15).iFrameListen)(),window.opener&&window.opener!==window&&(window.isInline=!0);var u=!1;function l(){d(),u=!u,sessionStorage.setItem("fullscreen",JSON.stringify(u))}function f(e,t){var n=$(e);t.preventDefault();var r=n[0].className.includes("contactHPI-modal")?"contactHPI":"contactAdmin",a="contactHPI"===r?"Feedback":"Problem "+n.find("#title").val();$.ajax({url:"/helpdesk",type:"POST",data:{type:r,subject:a,category:n.find("#category").val(),role:n.find("#role").val(),desire:n.find("#desire").val(),benefit:n.find("#benefit").val(),acceptanceCriteria:n.find("#acceptance_criteria").val(),currentState:n.find("#hasHappened").val(),targetState:n.find("#supposedToHappen").val()},success:function(e){var t;t="Feedback erfolgreich versendet!",n.modal("hide"),$.showNotification(t,"success",!0)},error:function(e){var t,n;t="Fehler beim senden des Feedbacks",n=e,$(o).modal("hide"),$(i).modal("hide"),"timeout"===t?$.showNotification("Zeitüberschreitung der Anfrage","warn",!0):$.showNotification(n,"danger",!0)}}),$(".contactHPI-modal").find(".btn-submit").prop("disabled",!0)}function p(){document.querySelector(".nav-sidebar").classList.remove("position-absolute")}function m(){document.querySelector(".nav-sidebar").classList.add("position-absolute"),introJs().setOptions({nextLabel:"Weiter",prevLabel:"Zurück",doneLabel:"Fertig",skipLabel:"Überspringen"}).start().oncomplete(p)}$(document).ready(function(){var e=document.querySelector(".mobile-nav-toggle"),t=document.querySelector(".mobile-search-toggle");e&&e.addEventListener("click",c),t&&t.addEventListener("click",s);var n=$(".modal");o=document.querySelector(".contactHPI-modal");var r=$(".feature-modal");i=document.querySelector(".contactAdmin-modal"),$(".submit-contactHPI").on("click",function(e){e.preventDefault(),$(".contactHPI-modal").find(".btn-submit").prop("disabled",!1),populateModalForm($(o),{title:"Wunsch oder Problem senden",closeLabel:"Abbrechen",submitLabel:"Senden",fields:{feedbackType:"userstory"}}),$(o).appendTo("body").modal("show")}),o.querySelector(".modal-form").addEventListener("submit",f.bind(this,o)),$(".submit-contactAdmin").on("click",function(e){e.preventDefault(),$(".contactAdmin-modal").find(".btn-submit").prop("disabled",!1),populateModalForm($(i),{title:"Admin deiner Schule kontaktieren",closeLabel:"Abbrechen",submitLabel:"Senden"}),$(i).appendTo("body").modal("show")}),i.querySelector(".modal-form").addEventListener("submit",f.bind(this,i)),i.querySelector(".modal-form").addEventListener("submit",f.bind(this,i)),n.find(".close, .btn-close").on("click",function(){n.modal("hide")}),$(".notification-dropdown-toggle").on("click",function(){$(this).removeClass("recent"),$(".notification-dropdown .notification-item.unread").each(function(){1!=$(this).data("read")&&((0,a.sendShownCallback)({notificationId:$(this).data("notification-id")}),(0,a.sendReadCallback)($(this).data("notification-id")),$(this).data("read",!0))})}),$(".btn-create-qr").on("click",function(){var e=kjua({text:window.location.href,render:"image"}),t=$(".qr-show");t.empty(),t.append(e)}),document.getElementById("searchBar")instanceof Object&&(document.querySelector(".mobile-nav-toggle").addEventListener("click",c),document.querySelector(".mobile-search-toggle").addEventListener("click",s)),u||(u=JSON.parse(sessionStorage.getItem("fullscreen"))||!1)&&d(),document.querySelector(".btn-fullscreen")&&document.querySelector(".btn-fullscreen").addEventListener("click",l),$(".btn-cancel").on("click",function(e){e.stopPropagation(),e.preventDefault();var t=$(".cancel-modal");populateModalForm(t,{title:"Bist du dir sicher, dass du die Änderungen verwerfen möchtest?"}),t.appendTo("body").modal("show")}),populateModalForm(r,{title:"Neue Features sind verfügbar",closeLabel:"Abbrechen"}),jQuery.expr[":"].Contains=jQuery.expr.createPseudo(function(e){return function(t){return jQuery(t).text().toUpperCase().indexOf(e.toUpperCase())>=0}}),$("input.js-search").on("keyup",function(e){return"Escape"===e.key&&$(e.target).val(""),"Unidentified"!==e.key&&($(".sc-card-title").find('.title:not(:Contains("'+$(e.target).val()+'"))').parents(".sc-card-wrapper").fadeOut(400),$(".sc-card-title").find('.title:Contains("'+$(e.target).val()+'")').parents(".sc-card-wrapper").fadeIn(400),!("Unidentified"===e.key))})}),window.addEventListener("DOMContentLoaded",function(){/^((?!chrome).)*safari/i.test(navigator.userAgent)||(0,r.setupFirebasePush)();var e=document.querySelector("#feedbackType");e&&(e.onchange=function(){"problem"===e.value?(document.getElementById("problemDiv").style.display="block",document.getElementById("userstoryDiv").style.display="none",document.querySelectorAll("#problemDiv input, #problemDiv textarea, #problemDiv select").forEach(function(e){e.required=!0}),document.querySelectorAll("#userstoryDiv input, #userstoryDiv textarea, #userstoryDiv select").forEach(function(e){e.required=!1})):(document.getElementById("problemDiv").style.display="none",document.getElementById("userstoryDiv").style.display="block",document.querySelectorAll("#problemDiv input, #problemDiv textarea, #problemDiv select").forEach(function(e){e.required=!1}),document.querySelectorAll("#userstoryDiv input, #userstoryDiv textarea, #userstoryDiv select").forEach(function(e){e.required=!0}),document.getElementById("acceptance_criteria").required=!1)})}),document.addEventListener("DOMContentLoaded",function(e){document.querySelector("body").classList.add("loaded")}),window.addEventListener("beforeunload",function(e){document.querySelector("body").classList.remove("loaded")}),window.addEventListener("pageshow",function(e){document.querySelector("body").classList.add("loaded")}),window.addEventListener("load",function(){("true"==localStorage.getItem("Tutorial")&&(m(),localStorage.setItem("Tutorial",!1)),"serviceWorker"in navigator)&&(1==parseInt(document.getElementById("testUserGroup").value)&&navigator.serviceWorker.register("/sw.js"));document.getElementById("intro-loggedin").addEventListener("click",m,!1)}),document.querySelectorAll("#main-content a").forEach(function(e){var t=e.getAttribute("href");null==e.querySelector("img, .fa")&&t&&(t.startsWith("https://schul-cloud.org")||t.startsWith("#")||t.startsWith("/")||""===t||(e.getAttribute("target")||e.setAttribute("target","_blank"),e.classList.add("externalLink")))})},9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCookiesMap=t.pushManager=void 0;var o=n(3),i=(t.pushManager={requestPermissionCallback:null,setRegistrationId:function(e,t,n){var c="deviceToken="+e;document.cookie=c+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/",n=navigator.platform;var s=a()?"mobile":"desktop",d=r();i(document.cookie).notificationPermission&&(0,o.sendRegistrationId)(e,t,n,s,d)},error:function(e,t){console.log(t||"Push error: ",e)},handleNotification:function(e){console.log("notification event",e)},requestPermission:function(){document.cookie="notificationPermission=true; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/",this.requestPermissionCallback&&(this.requestPermissionCallback(),setTimeout(function(){window.location.reload()},2e3))},registerSuccessfulSetup:function(e,t){this.requestPermissionCallback=t}},t.getCookiesMap=function(e){return e.split(";").map(function(e){return e.trim().split("=")}).reduce(function(e,t){return e[t[0]]=t[1],e},{})}),r=function e(){if(e.prototype._cachedResult)return e.prototype._cachedResult;var t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,n="undefined"!=typeof InstallTrigger,o=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString(),i=!!document.documentMode,r=!i&&!!window.StyleMedia,a=!!window.chrome&&!!window.chrome.webstore;(a||t)&&window.CSS;return e.prototype._cachedResult=t?"Opera":n?"Firefox":o?"Safari":a?"Chrome":i?"IE":r?"Edge":"Don't know"},a=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}}});